<br>
<div class="jumbotron jumbotron-fluid">

  <!--  Chart Overall Health Condition -->
  <script>
      $(function () {
          var chart;
          $(document).ready(function () {
              chart = new Highcharts.Chart({
                  chart: {
                      renderTo: 'overall_health_condition',
                      type: 'bar'
                  },
                  title: {
                      text: 'Health Condition VS Number of Patients'
                  },
                  xAxis: {
                      categories: [""],
                      //type: 'category',
                      labels: {
                          style: {
                              fontSize: '13px',
                              fontFamily: 'Verdana, sans-serif'
                          }
                      }
                  },
                  yAxis: {
                      min: 0,
                      title: {
                          text: 'Number of Patients'
                      }
                  },


                  plotOptions: {
                      column: {
                          pointPadding: 0.6,
                          borderWidth: 0.5
                      },
                      series: {
                          borderWidth: 0,
                          dataLabels: {
                              enabled: true,
                              format: '{point.y:f}'
                          },
                          groupPadding: 0.2
                      }
                  },


                  series: [
                      <%overall_condition.each do |row|%>
                      {
                          name: ['<%= row.condition%>'],
                          data: [<%= row.num_of_patient %>]
                      },
                      <% end %>
                  ],

              });
          });

      });
  </script>

  <!--  Chart High BP-->
  <script>
      $(function () {
          var chart;
          var today = new Date().getTime();
          var aYearAgo = new Date('2017/04/01').getTime();

          $(document).ready(function () {
              chart = new Highcharts.Chart({
                  chart: {
                      renderTo: 'high_bp',
                      type: 'column'
                  },
                  title: {
                      text: 'Number of Patients with High BP *'
                  },
                  xAxis: {
                      categories: [""],
                      // min: aYearAgo,
                      // max: today,
                      //type: 'category',
                      labels: {
                          style: {
                              fontSize: '13px',
                              fontFamily: 'Verdana, sans-serif'
                          }
                      }
                  },
                  yAxis: {
                      min: 0,
                      title: {
                          text: 'Number of Patients'
                      }
                  },


                  plotOptions: {
                      column: {
                          pointPadding: 0.4,
                          borderWidth: 0
                      },
                      series: {
                          borderWidth: 0,
                          dataLabels: {
                              enabled: true,
                              format: '{point.y:f}'
                          }
                      }
                  },


                  series: [
                      <% high_bp.each do |row|%>
                      {
                          name: ['<%= row.test_month%>'],
                          data: [<%= row.num_patients %>]
                      },
                      <% end %>
                  ],

              });
          });

      });
  </script>

  <!--  Chart Low BP-->
  <script>
      $(function () {
          var chart;
          $(document).ready(function () {
              chart = new Highcharts.Chart({
                  chart: {
                      renderTo: 'low_bp',
                      type: 'column'
                  },
                  title: {
                      text: 'Number of Patients with Low BP *'
                  },
                  xAxis: {
                      categories: [""],
                      //type: 'category',
                      labels: {
                          style: {
                              fontSize: '13px',
                              fontFamily: 'Verdana, sans-serif'
                          }
                      }
                  },
                  yAxis: {
                      min: 0,
                      title: {
                          text: 'Number of Patients'
                      }
                  },

                  plotOptions: {
                      column: {
                          pointPadding: 0.4,
                          borderWidth: 0
                      },
                      series: {
                          borderWidth: 0,
                          dataLabels: {
                              enabled: true,
                              format: '{point.y:f}'
                          }
                      }
                  },


                  series: [
                      <% low_bp.each do |row|%>
                      {
                          name: ['<%= row.test_month%>'],
                          data: [<%= row.num_patients %>]
                      },
                      <% end %>
                  ],

              });
          });

      });
  </script>

  <!--  Chart High Blood Sugar-->
  <script>
      $(function () {
          var chart;
          $(document).ready(function () {
              chart = new Highcharts.Chart({
                  chart: {
                      renderTo: 'high_blood_sugar',
                      type: 'column'
                  },
                  title: {
                      text: 'Number of Patients with High Blood Sugar *'
                  },
                  xAxis: {
                      categories: [""],
                      //type: 'category',
                      labels: {
                          style: {
                              fontSize: '13px',
                              fontFamily: 'Verdana, sans-serif'
                          }
                      }
                  },
                  yAxis: {
                      min: 0,
                      title: {
                          text: 'Number of Patients'
                      }
                  },

                  plotOptions: {
                      column: {
                          pointPadding: 0.4,
                          borderWidth: 0
                      },
                      series: {
                          borderWidth: 0,
                          dataLabels: {
                              enabled: true,
                              format: '{point.y:f}'
                          }
                      }
                  },


                  series: [
                      <% high_blood_sugar.each do |row|%>
                      {
                          name: ['<%= row.test_month%>'],
                          data: [<%= row.num_patients %>]
                      },
                      <% end %>
                  ],

              });
          });

      });
  </script>

  <!--  Chart Low Blood Sugar-->
  <script>
      $(function () {
          var chart;
          $(document).ready(function () {
              chart = new Highcharts.Chart({
                  chart: {
                      renderTo: 'low_blood_sugar',
                      type: 'column'
                  },
                  title: {
                      text: 'Number of Patients with Low Blood Sugar *'
                  },
                  xAxis: {
                      categories: [""],
                      //type: 'category',
                      labels: {
                          style: {
                              fontSize: '13px',
                              fontFamily: 'Verdana, sans-serif'
                          }
                      }
                  },
                  yAxis: {
                      min: 0,
                      title: {
                          text: 'Number of Patients'
                      }
                  },

                  plotOptions: {
                      column: {
                          pointPadding: 0.4,
                          borderWidth: 0
                      },
                      series: {
                          borderWidth: 0,
                          dataLabels: {
                              enabled: true,
                              format: '{point.y:f}'
                          }
                      }
                  },


                  series: [
                      <% low_blood_sugar.each do |row|%>
                      {
                          name: ['<%= row.test_month%>'],
                          data: [<%= row.num_patients %>]
                      },
                      <% end %>
                  ],

              });
          });

      });
  </script>

  <!--  Chart Low Blood  Oxygen Saturation-->
  <script>
      $(function () {
          var chart;
          $(document).ready(function () {
              chart = new Highcharts.Chart({
                  chart: {
                      renderTo: 'low_oxygen_saturation',
                      type: 'column'
                  },
                  title: {
                      text: 'Number of Patients with Low Blood Oxygen Saturation *'
                  },
                  xAxis: {
                      categories: [""],
                      //type: 'category',
                      labels: {
                          style: {
                              fontSize: '13px',
                              fontFamily: 'Verdana, sans-serif'
                          }
                      }
                  },
                  yAxis: {
                      min: 0,
                      title: {
                          text: 'Number of Patients'
                      }
                  },

                  plotOptions: {
                      column: {
                          pointPadding: 0.4,
                          borderWidth: 0
                      },
                      series: {
                          borderWidth: 0,
                          dataLabels: {
                              enabled: true,
                              format: '{point.y:f}'
                          }
                      }
                  },


                  series: [
                      <% low_oxygen_saturation.each do |row|%>
                      {
                          name: ['<%= row.test_month%>'],
                          data: [<%= row.num_patients %>]
                      },
                      <% end %>
                  ],

              });
          });

      });
  </script>

  <!--  Chart Doctor Vs. Specialty-->
  <script>
      $(function () {
          var chart;
          $(document).ready(function () {
              chart = new Highcharts.Chart({
                  chart: {
                      renderTo: 'doc_specialty',
                      type: 'column'
                  },
                  title: {
                      text: 'Doctor vs Specialty'
                  },
                  xAxis: {
                      categories: [""],
                      //type: 'category',
                      labels: {
                          enabled: false
                      }
                  },
                  yAxis: {
                      min: 0,
                      title: {
                          text: 'Number of Doctors'
                      }
                  },


                  plotOptions: {
                      column: {
                          pointPadding: 0.4,
                          borderWidth: 0
                      },
                      series: {
                          borderWidth: 0,
                          dataLabels: {
                              enabled: true,
                              format: '{point.y:f}'
                          }
                      }
                  },


                  series: [
                      <% doctor_specialty.each do |row|%>
                      {
                          name: ['<%= row.description%>'],
                          data: [<%= row.doctor_count %>]
                      },
                      <% end %>
                  ],

              });
          });

      });
  </script>

  <!--  Chart User Count-->
  <script>
      $(function () {
          var chart;
          $(document).ready(function () {
              chart = new Highcharts.chart('users_count', {
                  chart: {
                      type: 'pie',
                      options3d: {
                          enabled: true,
                          alpha: 45
                      }
                  },
                  title: {
                      text: 'Number of Users by Type'
                  },
                  plotOptions: {
                      pie: {
                          innerSize: 100,
                          depth: 45
                      }
                  },
                  series: [{
                      name: 'Users',
                      data: [
                          <% dashboard.each do |row|%>

                           ['<%= row.actable_type%>',<%= row.user_count %>],

                      <% end %>
                      ]
                  }],
              });
          });

      });
  </script>

  <div class="row">
    <div class="col">
      <%= form_tag(dashboard_path, :method => "get", id: "search-form") do %>
        <div class="row">
          <div class="col">


            <div class="field">
              <%= label :province, "Province" %>
              <%= collection_select :province, :province_id, Province.order(:name), :id, :name, include_blank: "" %>
            </div>

            <div class="field">
              <%= label :district, "District" %>
              <%= grouped_collection_select :district, :district_id, Province.order(:name), :districts, :name, :id, :district_name, :include_blank => "All Districts" %>
            </div>

          </div>
        </div>
        <%= submit_tag "Show", :name => 'search' %>
      <% end %>
    </div>
  </div>

  <br>
  <div class="row">
    <div class="col">
      <p class="text-danger">* Graphs display data of past 12 months</p>
    </div>
  </div>

  <div>
    <br>
    <% if @prov_name != 0 || @dist_name != 0 %>
      <p class="text">Displaying results for Province <b><%= @prov_name.name %></b>, district <b><%= @dist_name.district_name %></b></p>
    <% end %>
  </div>

  <br>
  <div class="row">
    <div class="col">
      <div id="users_count" style="min-width: 600px; height: 400px; margin: 0 auto"></div>
    </div>
    <div class="col">
      <div id="overall_health_condition" style="min-width: 600px; height: 400px; margin: 0 auto"></div>
    </div>
  </div>


  <br>
  <div class="row">
    <div class="col">
      <div id="high_bp" style="min-width: 600px; height: 400px; margin: 0 auto"></div>
    </div>
    <div class="col">
      <div id="low_bp" style="min-width: 600px; height: 400px; margin: 0 auto"></div>
    </div>
  </div>

  <br>
  <div class="row">
    <div class="col">
      <div id="high_blood_sugar" style="min-width: 600px; height: 400px; margin: 0 auto"></div>
    </div>
    <div class="col">
      <div id="low_blood_sugar" style="min-width: 600px; height: 400px; margin: 0 auto"></div>
    </div>
  </div>

  <br>
  <div class="row">
    <div class="col">
      <div id="doc_specialty" style="min-width: 600px; height: 400px; margin: 0 auto"></div>
    </div>
    <div class="col">
      <div id="low_oxygen_saturation" style="min-width: 600px; height: 400px; margin: 0 auto"></div>
    </div>
  </div>

</div>